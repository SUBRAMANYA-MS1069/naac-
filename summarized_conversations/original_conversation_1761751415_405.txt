{'role': 'assistant', 'content': 'Let\'s continue creating more services:\n\n<function_calls>\n<create-file file_path="src/services/tax/tdsService.js">\nconst TDSDeduction = require(\'../../models/tax/TDSDeduction\');\nconst { calculateTDS } = require(\'../../utils/calculators/taxCalculator\');\nconst { AppError } = require(\'../../utils/helpers/errorHelper\');\n\n/**\n * Create a new TDS deduction\n * @param {Object} tdsData - TDS deduction data\n * @param {String} tenantId - Tenant ID\n * @returns {Object} Created TDS deduction\n */\nconst createTDSDeduction = async (tdsData, tenantId) => {\n  try {\n    // Add tenantId to TDS data\n    tdsData.tenantId = tenantId;\n    \n    // Calculate TDS amounts\n    const tdsCalculation = calculateTDS(tdsData.grossAmount, tdsData.tdsRate);\n    \n    tdsData.tdsAmount = tdsCalculation.tdsAmount;\n    tdsData.netAmount = tdsCalculation.netAmount;\n    \n    // Create TDS deduction\n    const tdsDeduction = new TDSDeduction(tdsData);\n    await tdsDeduction.save();\n    \n    return tdsDeduction;\n  } catch (error) {\n    if (error.code === 11000) {\n      throw new AppError(\'TDS deduction with this details already exists\', 409, \'DUPLICATE_TDS_DEDUCTION\');\n    }\n    throw error;\n  }\n};\n\n/**\n * Get TDS deductions with filters\n * @param {Object} filters - Filter criteria\n * @param {Object} pagination - Pagination options\n * @param {String} tenantId - Tenant ID\n * @returns {Object} TDS deductions and pagination info\n */\nconst getTDSDeductions = async (filters, pagination, tenantId) => {\n  try {\n    const query = { tenantId, ...filters };\n    \n    // Handle section filter\n    if (filters.section) {\n      query.section = filters.section;\n    }\n    \n    // Handle financial year filter\n    if (filters.financialYear) {\n      query.financialYear = filters.financialYear;\n    }\n    \n    // Handle quarter filter\n    if (filters.quarter) {\n      query.quarter = filters.quarter;\n    }\n    \n    // Handle date range filter\n    if (filters.startDate || filters.endDate) {\n      query.paymentDate = {};\n      if (filters.startDate) {\n        query.paymentDate.$gte = new Date(filters.startDate);\n      }\n      if (filters.endDate) {\n        query.paymentDate.$lte = new Date(filters.endDate);\n      }\n    }\n    \n    const deductions = await TDSDeduction.find(query)\n      .sort(pagination.sort || \'-paymentDate\')\n      .skip(pagination.skip)\n      .limit(pagination.limit);\n    \n    const total = await TDSDeduction.countDocuments(query);\n    \n    return {\n      deductions,\n      total,\n      page: pagination.page,\n      limit: pagination.limit\n    };\n  } catch (error) {\n    throw new AppError(\'Failed to fetch TDS deductions\', 500, \'FETCH_TDS_DEDUCTIONS_ERROR\');\n  }\n};\n\n/**\n * Get TDS deduction by ID\n * @param {String} deductionId - Deduction ID\n * @param {String} tenantId - Tenant ID\n * @returns {Object} TDS deduction\n */\nconst getTDSDeductionById = async (deductionId, tenantId) => {\n  try {\n    const deduction = await TDSDeduction.findOne({ tdsDeductionId: deductionId, tenantId });\n    \n    if (!deduction) {\n      throw new AppError(\'TDS deduction not found\', 404, \'TDS_DEDUCTION_NOT_FOUND\');\n    }\n    \n    return deduction;\n  } catch (error) {\n    if (error.name === \'CastError\') {\n      throw new AppError(\'Invalid TDS deduction ID\', 400, \'INVALID_TDS_DEDUCTION_ID\');\n    }\n    throw error;\n  }\n};\n\n/**\n * Update TDS deduction\n * @param {String} deductionId - Deduction ID\n * @param {Object} updateData - Update data\n * @param {String} tenantId - Tenant ID\n * @returns {Object} Updated TDS deduction\n */\nconst updateTDSDeduction = async (deductionId, updateData, tenantId) => {\n  try {\n    // Recalculate TDS if gross amount or rate is updated\n    if (updateData.grossAmount !== undefined || updateData.tdsRate !== undefined) {\n      const grossAmount = updateData.grossAmount || (await TDSDeduction.findOne({ tdsDeductionId: deductionId, tenantId }))?.grossAmount;\n      const tdsRate = updateData.tdsRate || (await TDSDeduction.findOne({ tdsDeductionId: deductionId, tenantId }))?.tdsRate;\n      \n      const tdsCalculation = calculateTDS(grossAmount, tdsRate);\n      \n      updateData.tdsAmoun...\n The full message content is stored at /workspace/summarized_conversations/original_conversation_1761751241_2567.txt'}